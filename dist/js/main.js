'use strict';function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var signList=['<i class="fa fa-firefox"></i>','<i class="fa fa-firefox"></i>','<i class="fa fa-firefox"></i>','<i class="fa fa-firefox"></i>','<i class="fa fa-firefox"></i>','<i class="fa fa-firefox"></i>','<i class="fa fa-firefox"></i>','<i class="fa fa-firefox"></i>'],matchMode=!1;function createSignArray(a){return[].concat(_toConsumableArray(a),_toConsumableArray(a))}function shuffle(a){for(var b,d,c=a.length;c;)b=Math.floor(Math.random()*c--),d=a[c],a[c]=a[b],a[b]=d;return a}function setCookie(a,b,c){var e=new Date;e.setTime(e.getTime()+1e3*(60*(60*(24*c))));var d='expires='+e.toUTCString();document.cookie=a+'='+b+';'+d+';path=/'}function getCookie(a){for(var b,c=a+'=',d=document.cookie.split(';'),e=0;e<d.length;e++){for(b=d[e];' '==b.charAt(0);)b=b.substring(1);if(0==b.indexOf(c))return b.substring(c.length,b.length)}return''}function deleteCookie(a){document.cookie=a+'=; expires=Thu, 01 Jan 1970 00:00:01 GMT;'}var playDuration,clockState,clock,tier,matchedNumber=0,unmatchedNumber=0,moves=0,scores=0;function finishing(){var a=Math.floor;tier=a(--playDuration/30);var b=$('#summarize-stars');0==tier?(console.log('Best'),b.html('<i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>')):1==tier?(console.log('Good'),b.html('<i class="fa fa-star" aria-hidden="true"></i><i class="fa fa-star" aria-hidden="true"></i>')):(console.log('Keep Practice'),b.html('<i class="fa fa-star" aria-hidden="true"></i>')),$('#summarize-moves').text(moves),scores=a(180*moves/playDuration),$('#scores').text(scores),$('.board').removeClass('board--hide'),$('.board__slide').removeClass('board__slide--animation-slidetoleft board__slide--animation-slidetoorigin')}var rank=[];function addToRank(){rank.push([name,scores])}function ranking(){rank.sort(function(c,a){return a[1]-c[1]}),rank.splice(10,rank.length-10)}function saveRank(){var a=[],b=!0,c=!1,d=void 0;try{for(var e,f,g=rank[Symbol.iterator]();!(b=(e=g.next()).done);b=!0)f=e.value,a.push(f.join('@'))}catch(a){c=!0,d=a}finally{try{!b&&g.return&&g.return()}finally{if(c)throw d}}a=a.join('&'),setCookie('rank',a,7)}function loadRank(){var a=[],b=getCookie('rank');if(b){b=b.split('&');var c=!0,d=!1,e=void 0;try{for(var f,g,h=b[Symbol.iterator]();!(c=(f=h.next()).done);c=!0)g=f.value,g=g.split('@'),a.push(g)}catch(a){d=!0,e=a}finally{try{!c&&h.return&&h.return()}finally{if(d)throw e}}rank=a}}function resetRank(){rank=[],$('#rankboard').empty(),deleteCookie('rank')}function refreshRankBoard(){var a=getCookie('rank');if(a){$('#rankboard').empty();var e=1,f=!0,g=!1,h=void 0;try{for(var b,c,d=rank[Symbol.iterator]();!(f=(b=d.next()).done);f=!0)c=b.value,$('#rankboard').append('<li class="rankboard__entry"><span class="rankboard__rank">'+e++ +'</span><span class="rankboard__name">'+c[0]+'</span><span class="rankboard__scores">'+c[1]+'</span>Points</li>')}catch(a){g=!0,h=a}finally{try{!f&&d.return&&d.return()}finally{if(g)throw h}}}}var elemPlayDuration=$('#play-duration'),elemMoves=$('#moves');function initGame(){playDuration=0,matchedNumber=0,unmatchedNumber=0,moves=0,scores=0,elemPlayDuration.text(''),elemMoves.text('');var a=shuffle(createSignArray(signList));$('.card').each(function(b){$(this).removeClass('card--flag-matched card--animation-reveal card--animation-match card--animation-unmatch card--flag-active'),$(this).html(a[b])})}function startGame(){clockState=20}function pauseGame(){clockState=0}function resumeGame(){clockState=20}function saveGame(){pauseGame();var a='';$('.card').each(function(){a+=$(this).attr('class')+'@'+$(this).html()+'@@'}),localStorage.setItem('cardsData',a),localStorage.setItem('clockState',clockState),localStorage.setItem('playDuration',playDuration),localStorage.setItem('moves',moves),resumeGame()}function loadGame(){pauseGame();var a=localStorage.getItem('cardsData');a=a.split('@@'),a.forEach(function(b,c){a[c]=b.split('@')}),$('.card').each(function(b){$(this).removeClass('card'),$(this).addClass(a[b][0]),$(this).html(a[b][1])}),clockState=+localStorage.getItem('clockState'),playDuration=+localStorage.getItem('playDuration'),moves=+localStorage.getItem('moves'),resumeGame()}function isEnabled(a){var b=matchMode||a.hasClass('card--flag-matched');return!b}function activate(a){a.addClass('card--animation-reveal card--flag-active')}function matching(a){2==a.length&&(matchMode=!0,a.first().html()==a.last().html()?(matchedNumber++,console.log(matchedNumber),moves++,console.log('moves: '+moves),a.addClass('card--animation-match'),window.setTimeout(function(){a.addClass('card--flag-matched'),a.removeClass('card--animation-reveal card--flag-active'),matchMode=!1},600)):(unmatchedNumber++,console.log(unmatchedNumber),moves++,console.log('moves: '+moves),a.addClass('card--animation-unmatch'),window.setTimeout(function(){a.removeClass('card--animation-reveal card--animation-unmatch card--flag-active'),matchMode=!1},1e3)))}function refreshStatus(){elemPlayDuration.text(playDuration++),elemMoves.text(moves)}$(document).ready(function(){clock=window.setInterval(function(){switch(clockState){case 0:break;case 20:refreshStatus();}},1e3),loadRank(),refreshRankBoard()}),$('#btn-start').click(function(){initGame(),startGame()}),$('#btn-save').click(function(){saveGame()}),$('#btn-load').click(function(){loadGame()}),$('.card').click(function(){isEnabled($(this))&&(activate($(this)),matching($('.card--flag-active')),setTimeout(function(){16==$('.card--flag-matched').length&&(pauseGame(),finishing())},600))}),$('#btn-replay').click(function(){initGame(),$('.board__slide').removeClass('board__slide--animation-slidetoleft board__slide--animation-slidetoorigin'),$('.board').addClass('board--hide')}),$('#btn-log').click(function(){$('.board__slide').removeClass('board__slide--animation-slidetoleft board__slide--animation-slidetoorigin'),$('.board__slide').addClass('board__slide--animation-slidetoleft')}),$('#btn-return').click(function(){$('.board__slide').removeClass('board__slide--animation-slidetoleft board__slide--animation-slidetoorigin'),$('.board__slide').addClass('board__slide--animation-slidetoorigin')});var name='';$('#btn-confirm').click(function(){name=$('#ipt-name').val(),name?(console.log(name),addToRank(),ranking(),saveRank(),refreshRankBoard(),$('.board').addClass('board--hide')):console.log('empty!')}),$('#btn-resetrank').click(function(){resetRank()});